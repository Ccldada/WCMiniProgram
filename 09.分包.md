## åˆ†åŒ…åŠ è½½

### 1. ä»€ä¹ˆæ˜¯åˆ†åŒ…åŠ è½½

**ä»€ä¹ˆæ˜¯åˆ†åŒ…åŠ è½½** â“

å°ç¨‹åºçš„ä»£ç é€šå¸¸æ˜¯ç”±è®¸å¤šé¡µé¢ã€ç»„ä»¶ä»¥åŠèµ„æºç­‰ç»„æˆï¼Œéšç€å°ç¨‹åºåŠŸèƒ½çš„å¢åŠ ï¼Œä»£ç é‡ä¹Ÿä¼šé€æ¸å¢åŠ ï¼Œä½“ç§¯è¿‡å¤§å°±ä¼šå¯¼è‡´ç”¨æˆ·æ‰“å¼€é€Ÿåº¦å˜æ…¢ï¼Œå½±å“ç”¨æˆ·çš„ä½¿ç”¨ä½“éªŒã€‚

åˆ†åŒ…åŠ è½½æ˜¯ä¸€ç§å°ç¨‹åºä¼˜åŒ–æŠ€æœ¯ã€‚å°†å°ç¨‹åºä¸åŒåŠŸèƒ½çš„ä»£ç ï¼Œåˆ†åˆ«æ‰“åŒ…æˆä¸åŒçš„å­åŒ…ï¼Œåœ¨æ„å»ºæ—¶æ‰“åŒ…æˆä¸åŒçš„åˆ†åŒ…ï¼Œç”¨æˆ·åœ¨ä½¿ç”¨æ—¶æŒ‰éœ€è¿›è¡ŒåŠ è½½ï¼Œåœ¨æ„å»ºå°ç¨‹åºåˆ†åŒ…é¡¹ç›®æ—¶ï¼Œæ„å»ºä¼šè¾“å‡ºä¸€ä¸ªæˆ–å¤šä¸ªåˆ†åŒ…ã€‚æ¯ä¸ªä½¿ç”¨åˆ†åŒ…å°ç¨‹åºå¿…å®šå«æœ‰ä¸€ä¸ªä¸»åŒ…ã€‚æ¯ä¸ªåˆ†åŒ…å¯ä»¥åŒ…å«å¤šä¸ªé¡µé¢ã€ç»„ä»¶ã€æ ·å¼å’Œé€»è¾‘ç­‰ã€‚å½“å°ç¨‹åºéœ€è¦ä½¿ç”¨æŸä¸ªåˆ†åŒ…æ—¶ï¼Œæ‰ä¼šåŠ è½½è¯¥åˆ†åŒ…ä¸­çš„ä»£ç ã€‚

**ä¸»åŒ…ï¼š**åŒ…å«é»˜è®¤å¯åŠ¨é¡µé¢ / TabBar é¡µé¢ ä»¥åŠ æ‰€æœ‰åˆ†åŒ…éƒ½éœ€ç”¨åˆ°å…¬å…±èµ„æºçš„åŒ…

**åˆ†åŒ…ï¼š**æ ¹æ®å¼€å‘è€…çš„é…ç½®è¿›è¡Œåˆ’åˆ†å‡ºæ¥çš„å­åŒ…

**å°ç¨‹åºåˆ†åŒ…åå¦‚ä½•åŠ è½½** 

åœ¨å°ç¨‹åºå¯åŠ¨æ—¶ï¼Œé»˜è®¤ä¼šä¸‹è½½ä¸»åŒ…å¹¶å¯åŠ¨ä¸»åŒ…å†…é¡µé¢ï¼Œåœ¨ç”¨æˆ·è®¿é—®åˆ†åŒ…å†…æŸä¸ªé¡µé¢æ—¶ï¼Œå¾®ä¿¡å®¢æˆ·ç«¯æ‰ä¼šæŠŠå¯¹åº”åˆ†åŒ…ä¸‹è½½ä¸‹æ¥ï¼Œä¸‹è½½å®Œæˆåå†è¿›è¡Œå±•ç¤ºã€‚

**ç›®å‰å°ç¨‹åºåˆ†åŒ…å¤§å°æœ‰ä»¥ä¸‹é™åˆ¶ï¼š****

1. **æ•´ä¸ªå°ç¨‹åºæ‰€æœ‰åˆ†åŒ…å¤§å°ä¸è¶…è¿‡ 20MB**
2. **å•ä¸ªåˆ†åŒ…/ä¸»åŒ…å¤§å°ä¸èƒ½è¶…è¿‡ 2MB**

> ğŸ“Œ **æ³¨æ„äº‹é¡¹**ï¼š
>
> â€‹	æ•´ä¸ªå°ç¨‹åºæ‰€æœ‰åˆ†åŒ…å¤§å°å¯èƒ½ä¼šéšæ—¶è°ƒæ•´ï¼Œæˆªæ­¢åˆ°ç›®å‰æ•´ä¸ªå°ç¨‹åºæ‰€æœ‰åˆ†åŒ…å¤§å°ä¸è¶…è¿‡ 20M

###2. åˆ†åŒ…çš„åŸºæœ¬ä½¿ç”¨

**çŸ¥è¯†ç‚¹ï¼š**
åœ¨è¿›è¡Œåˆ†åŒ…åŠ è½½ä¹‹å‰ï¼Œéœ€è¦å¯¹å°ç¨‹åºçš„ä¸šåŠ¡é€»è¾‘è¿›è¡Œåˆ†æï¼Œå°†ä»£ç åˆ’åˆ†æˆå¤šä¸ªæ¨¡å—ã€‚**æ¯ä¸ªæ¨¡å—åº”è¯¥æœ‰ä¸€ä¸ªæ˜ç¡®çš„åŠŸèƒ½**ï¼Œå¹¶ä¸å…¶ä»–æ¨¡å—ä¹‹é—´æœ‰æ˜ç¡®çš„ä¾èµ–å…³ç³»

> éœ€è¦æŒ‰ç…§åŠŸèƒ½æ‹†åˆ†åˆ†åŒ…ï¼Œå¹¶ä¸”æ¯ä¸ªåˆ†åŒ…éƒ½éœ€è¦ä¸å…¶ä»–åŒ…æœ‰ä¾èµ–å…³ç³»(å¯ä»¥é€šè¿‡ a åˆ†åŒ…è·³è½¬åˆ° b åˆ†åŒ…)

å¼€å‘è€…åœ¨å°ç¨‹åºçš„é…ç½®æ–‡ä»¶ `app.json` ä¸­ï¼Œé€šè¿‡ `subPackages` æˆ–è€… `subpackages`å­—æ®µå£°æ˜é¡¹ç›®åˆ†åŒ…ç»“æ„ã€‚

æ¯ä¸ªåˆ†åŒ…éœ€è¦æŒ‡å®š `root` å­—æ®µã€`name` å­—æ®µå’Œ `pages` å­—æ®µ
1. `root` å­—æ®µæŒ‡å®šäº†åˆ†åŒ…çš„æ ¹ç›®å½•ï¼Œè¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶éƒ½ä¼šè¢«æ‰“åŒ…æˆä¸€ä¸ªç‹¬ç«‹çš„åŒ…
2. `name` å­—æ®µä¸ºåˆ†åŒ…çš„åç§°ï¼Œç”¨äºåœ¨ä»£ç ä¸­å¼•ç”¨è¯¥åˆ†åŒ…
3. `pages` å­—æ®µæŒ‡å®šäº†è¯¥åˆ†åŒ…ä¸­åŒ…å«çš„é¡µé¢ï¼Œå¯ä»¥ä½¿ç”¨é€šé…ç¬¦ `*` åŒ¹é…å¤šä¸ªé¡µé¢

**è½åœ°ä»£ç ï¼š**

```json
{

  "subPackages": [
    {
      "root": "modules/goodModule",
      "name": "goodModule",
      "pages": [
        "pages/list/list",
        "pages/detail/detail"
      ]
    },
    {
      "root": "modules/marketModule",
      "name": "marketModule",
      "pages": [
        "pages/market/market"
      ]
    }
  ]

}

```

### 3. æ‰“åŒ…å’Œå¼•ç”¨åŸåˆ™(æ³¨æ„äº‹é¡¹)

æ‰“åŒ…åŸåˆ™ï¼š
1. tabBar é¡µé¢å¿…é¡»åœ¨ä¸»åŒ…å†…
2. æœ€å¤–å±‚çš„ pages å­—æ®µï¼Œå±äºä¸»åŒ…çš„åŒ…å«çš„é¡µé¢
3. æŒ‰ subpackages é…ç½®è·¯å¾„è¿›è¡Œæ‰“åŒ…ï¼Œé…ç½®è·¯å¾„å¤–çš„ç›®å½•å°†è¢«æ‰“åŒ…åˆ°ä¸»åŒ…ä¸­
4. åˆ†åŒ…ä¹‹é—´ä¸èƒ½ç›¸äº’åµŒå¥—ï¼Œsubpackage çš„æ ¹ç›®å½•ä¸èƒ½æ˜¯å¦å¤–ä¸€ä¸ª subpackage å†…çš„å­ç›®å½•

å¼•ç”¨åŸåˆ™ï¼š
1. ä¸»åŒ…ä¸å¯ä»¥å¼•ç”¨åˆ†åŒ…çš„èµ„æºï¼Œä½†åˆ†åŒ…å¯ä»¥ä½¿ç”¨ä¸»åŒ…çš„å…¬å…±èµ„æº
2. åˆ†åŒ…ä¸åˆ†åŒ…ä¹‹é—´èµ„æºæ— æ³•ç›¸äº’å¼•ç”¨ï¼Œ åˆ†åŒ…å¼‚æ­¥åŒ–æ—¶ä¸å—æ­¤æ¡é™åˆ¶

### 4. ç‹¬ç«‹åˆ†åŒ…çš„é…ç½®

**ä»€ä¹ˆæ˜¯ç‹¬ç«‹åˆ†åŒ…**ï¼š
ç‹¬ç«‹åˆ†åŒ…ï¼šç‹¬ç«‹åˆ†åŒ…æ˜¯å°ç¨‹åºä¸­ä¸€ç§ç‰¹æ®Šç±»å‹çš„åˆ†åŒ…ï¼Œå¯ä»¥**ç‹¬ç«‹äºä¸»åŒ…å’Œå…¶ä»–åˆ†åŒ…è¿è¡Œ**ã€‚

ä»ç‹¬ç«‹åˆ†åŒ…ä¸­é¡µé¢è¿›å…¥å°ç¨‹åºæ—¶ï¼Œä¸éœ€è¦ä¸‹è½½ä¸»åŒ…ï¼Œä½†æ˜¯å½“ç”¨æˆ·è¿›å…¥æ™®é€šåˆ†åŒ…æˆ–ä¸»åŒ…å†…é¡µé¢æ—¶ï¼Œä¸»åŒ…æ‰ä¼šè¢«ä¸‹è½½ ï¼

å¼€å‘è€…å¯ä»¥å°†åŠŸèƒ½ç›¸å¯¹ç‹¬ç«‹çš„é¡µé¢é…ç½®åˆ°ç‹¬ç«‹åˆ†åŒ…ä¸­ï¼Œå› ä¸ºç‹¬ç«‹åˆ†åŒ…ä¸ä¾èµ–ä¸»åŒ…å³å¯è¿è¡Œï¼Œå¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šæå‡åˆ†åŒ…é¡µé¢çš„å¯åŠ¨é€Ÿåº¦

> å¦‚æœæ˜¯ç‹¬ç«‹åˆ†åŒ…ï¼Œä¸éœ€è¦ä¸‹è½½ä¸»åŒ…ï¼Œç›´æ¥å°±èƒ½å¤Ÿè®¿é—®ï¼Œç‹¬ç«‹åˆ†åŒ…æ˜¯è‡ªå·±ç‹¬ç«‹è¿è¡Œçš„
> è€Œå¦‚æœæ˜¯å…¶ä»–åˆ†åŒ…ï¼Œéœ€è¦å…ˆä¸‹è½½ä¸»åŒ…ï¼Œé€šè¿‡è·¯å¾„è®¿é—®ï¼Œæ‰èƒ½åŠ è½½å¯¹åº”è·¯å¾„çš„åˆ†åŒ…

> ğŸ“Œ **æ³¨æ„äº‹é¡¹ï¼š**
> 1. ç‹¬ç«‹åˆ†åŒ…ä¸­ä¸èƒ½ä¾èµ–ä¸»åŒ…å’Œå…¶ä»–åˆ†åŒ…ä¸­çš„èµ„æº
> 2. ä¸»åŒ…ä¸­çš„ app.wxss å¯¹ç‹¬ç«‹åˆ†åŒ…æ— æ•ˆ
> 3. App åªèƒ½åœ¨ä¸»åŒ…å†…å®šä¹‰ï¼Œç‹¬ç«‹åˆ†åŒ…ä¸­ä¸èƒ½å®šä¹‰ Appï¼Œä¼šé€ æˆæ— æ³•é¢„æœŸçš„è¡Œä¸º

**å¦‚ä½•é…ç½®ç‹¬ç«‹åˆ†åŒ…ï¼š**

å¼€å‘è€…åœ¨`app.json`ä¸­æ‰¾åˆ°éœ€è¦é…ç½®ä¸ºç‹¬ç«‹åˆ†åŒ…çš„`subpackages`å­—æ®µ
åœ¨è¯¥å­—æ®µé…ç½®é¡¹ä¸­å®šä¹‰`independent`å­—æ®µå£°æ˜å¯¹åº”åˆ†åŒ…ä¸ºç‹¬ç«‹åˆ†åŒ…ã€‚

**è½åœ°ä»£ç ï¼š**

```json
{

  "subPackages": [
    {
      "root": "modules/goodModule",
      "name": "goodModule",
      "pages": [
        "pages/list/list",
        "pages/detail/detail"
      ]
    },
    {
      "root": "modules/marketModule",
      "name": "marketModule",
      "pages": [
        "pages/market/market"
      ],
+       "independent": true
    }
  ]
}

```

### 5. åˆ†åŒ…é¢„ä¸‹è½½

**çŸ¥è¯†ç‚¹ï¼š**
åˆ†åŒ…é¢„ä¸‹è½½æ˜¯æŒ‡è®¿é—®å°ç¨‹åºæŸä¸ªé¡µé¢æ—¶ï¼Œé¢„å…ˆä¸‹è½½åˆ†åŒ…ä¸­çš„ä»£ç å’Œèµ„æºï¼Œä»¥æé«˜ç”¨æˆ·çš„ä½¿ç”¨ä½“éªŒã€‚å½“ç”¨æˆ·éœ€è¦è®¿é—®åˆ†åŒ…ä¸­çš„é¡µé¢æ—¶ï¼Œå·²ç»é¢„å…ˆä¸‹è½½çš„ä»£ç å’Œèµ„æºå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œé€šè¿‡åˆ†åŒ…é¢„ä¸‹è½½åŠ å¿«äº†é¡µé¢çš„åŠ è½½é€Ÿåº¦å’Œæ˜¾ç¤ºé€Ÿåº¦ã€‚

å°ç¨‹åºçš„åˆ†åŒ…é¢„ä¸‹è½½éœ€è¦åœ¨ `app.json` ä¸­é€šè¿‡ `preloadRule` å­—æ®µè®¾ç½®é¢„ä¸‹è½½è§„åˆ™ã€‚`preloadRule` æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡çš„ `key` è¡¨ç¤ºè®¿é—®å“ªä¸ªè·¯å¾„æ—¶è¿›è¡Œé¢„åŠ è½½ï¼Œ`value` æ˜¯è¿›å…¥æ­¤é¡µé¢çš„é¢„ä¸‹è½½é…ç½®ï¼Œå…·æœ‰ä¸¤ä¸ªé…ç½®é¡¹ï¼š

| å­—æ®µ     | ç±»å‹        | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜                                                         |
| -------- | ----------- | ---- | ------ | ------------------------------------------------------------ |
| packages | StringArray | æ˜¯   | æ—      | é¢„ä¸‹è½½çš„åˆ†åŒ…åç§°ï¼Œè¿›å…¥é¡µé¢åé¢„ä¸‹è½½åˆ†åŒ…çš„ `root` æˆ– `name`<br />`__APP__` è¡¨ç¤ºä¸»åŒ…ã€‚ |
| network  | String      | å¦   | wifi   | åœ¨æŒ‡å®šç½‘ç»œä¸‹é¢„ä¸‹è½½ï¼Œ<br />å¯é€‰å€¼ä¸ºï¼š `all`: ä¸é™ç½‘ç»œ `wifi`: ä»…wifiä¸‹é¢„ä¸‹è½½ |

```json
{
  "subPackages": [
    {
      "root": "modules/goodModule",
      "name": "goodModule",
      "pages": [
        "pages/list/list",
        "pages/detail/detail"
      ]
    },
    {
      "root": "modules/marketModule",
      "name": "marketModule",
      "pages": [
        "pages/market/market"
      ],
      "independent": true
    }
  ],
  "preloadRule": {
    "pages/index/index": {
      "network": "all",
      "packages": ["modules/goodModule"]
    },
    "modules/marketModule/pages/market/market": {
      "network": "all",
      "packages": ["__APP__"]
    }
  }
}
```

**è½åœ°ä»£ç **ï¼š

```json
{
  "pages": [
    "pages/index/index",
    "pages/user/user"
  ],
  "subPackages": [
    {
      "root": "pages/music",
      "name": "music",
      "pages": [
        "player/player",
        "lyric/lyric"
      ]
    },
    {
      "root": "pages/settings",
      "name": "settings",
      "pages": [
        "theme/theme",
        "language/language"
      ]
    }
  ],
  "preloadRule": {
    "pages/music/player/player": {
      "packages": ["settings"],
      "network": "wifi"
    }
  }
}
```




